[![conference](https://img.shields.io/badge/Paper-CVPRW23-1c75b8?logo=data:image/svg%2bxml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2Vy
dmUiIHdpZHRoPSIyMjMuOTA5IiBoZWlnaHQ9IjI1NS44NyIgdmlld0JveD0iMCAwIDU5LjI0MyA2
Ny42OTkiPjxwYXRoIGQ9Ik02OS4wNzEgMTcxLjcyMWMwLS4xNDYtLjE4Ni0uMjY1LS40MTQtLjI2
NS0uNzIgMC0zLjE0Ny0yLjY4My0zLjQ5Ny0zLjg2Ny0uNDY1LTEuNTczLS40NjUtNTcuMzY4IDAt
NTguOTQuMzUtMS4xODQgMi43NzctMy44NjggMy40OTctMy44NjguMjI4IDAgLjQxNC0uMTE5LjQx
NC0uMjY0IDAtLjE3NCA1LjI4OC0uMjUxIDE1LjQxMi0uMjI1bDE1LjQxMi4wMzkgNi44MTMgNi45
MjEgNi44MTMgNi45MjF2OS4zNjNoMi41MjdjMi4zOTIgMCAyLjU2LjAzNyAzLjE3NS43LjM1Ni4z
ODUuNjQ4IDEuMDIyLjY0OCAxLjQxNiAwIC43OTMtMS4wNjcgMi4xMTctMS43MDcgMi4xMTctLjM1
MiAwLS40MS41NzYtLjQxIDQuMSAwIDIuNDU1LjEwMyA0LjEwMi4yNTYgNC4xMDIuMTQgMCAxLjAz
My43MjggMS45ODUgMS42MTkgNS4zMTMgNC45NyA1LjQyNCAxMi45NzIuMjUyIDE4LjE1OC0xLjY0
OCAxLjY1Mi00LjA3NiAzLjA2Ny01LjgzMyAzLjM5N2wtLjgyNy4xNTYtLjEyMSAyLjAyN2MtLjA4
MSAxLjM1NS0uMzA4IDIuMzktLjY4NSAzLjEyMy0uNTg3IDEuMTQxLTIuNTM3IDMuMDA1LTMuMTQ0
IDMuMDA1LS4xOTIgMC0uMzQ5LjEyLS4zNDkuMjY1IDAgLjE3NC02Ljg3OS4yNjUtMjAuMTA4LjI2
NS0xMy4yMyAwLTIwLjEwOS0uMDkxLTIwLjEwOS0uMjY1em0zOS41NjgtNC42MThjLjU0My0uNTQ0
LjY1LS45MDUuNjUtMi4yMnYtMS41N2wtLjk5My0uMTg2Yy0yLjgxOC0uNTI3LTYuOTIzLTMuNzkx
LTguMjQ0LTYuNTU1LTEuODM2LTMuODM3LTEuNzg2LTcuOTM5LjE0LTExLjc0Ni43NjQtMS41MSAz
LjQ2Mi00LjQ0NiA0LjM0My00LjcyNi40ODctLjE1NC41Mi0uNDIyLjUyLTQuMjQ4IDAtMy41MDkt
LjA1OC00LjA4My0uNDEtNC4wODMtLjY2NCAwLTEuNzA3LTEuMzI0LTEuNzA3LTIuMTY3IDAtLjQ2
Mi4yNTktMS4wMjYuNjUtMS40MTcuNTk4LS41OTkuODQ2LS42NSAzLjE3NS0uNjVoMi41MjV2LTYu
MzQ5aC0zLjYwN2MtNC40OSAwLTUuMzkzLS4yNTEtNy4xMTctMS45NzYtMS43MjUtMS43MjUtMS45
NzYtMi42MjctMS45NzYtNy4xMTd2LTMuNjA3SDcwLjM3bC0uNjUuNjQ5LS42NDkuNjV2NTYuNjY4
bC42NS42NS42NS42NWgzNy42MTl6bS0zNC42ODUtMjkuNjg0Yy0uODQ0LS45MS0uODQzLTIuMDQg
MC0yLjg4NC41NjgtLjU2Ny44ODctLjY1IDIuNTI2LS42NSAxLjY5IDAgMS45NDIuMDcgMi41MjYu
Ny4zNTcuMzg2LjY0OSAxLjAyMy42NDkgMS40MTcgMCAuMzk0LS4yOTIgMS4wMzItLjY0OSAxLjQx
Ny0uNTg0LjYzLS44MzYuNy0yLjUyNi43cy0xLjk0Mi0uMDctMi41MjYtLjd6bTEwLjU4MyAwYy0u
ODQzLS45MS0uODQzLTIuMDQgMC0yLjg4NC42MzMtLjYzMi43NTYtLjY1IDQuNjQzLS42NSAzLjk3
OSAwIDMuOTk2LjAwNCA0LjY0My43LjM1Ni4zODYuNjQ4IDEuMDIzLjY0OCAxLjQxNyAwIC4zOTQt
LjI5MiAxLjAzMi0uNjQ4IDEuNDE3LS42NDcuNjk3LS42NjQuNy00LjY0My43LTMuOTggMC0zLjk5
Ny0uMDAzLTQuNjQzLS43em0tMTAuNTgzLTguNDE2Yy0uNDEtLjQxLS42NS0uOTUyLS42NS0xLjQ2
NyAwLS41MTYuMjQtMS4wNTguNjUtMS40NjhsLjY1LS42NWgxOC41N2wuNjQ5LjcwMWMuODUuOTE3
LjgzMSAxLjk1NS0uMDUgMi44MzZsLS42OTcuNjk3SDc0LjYwNHptMC04LjUxOGMtLjg0NC0uOTEt
Ljg0My0yLjA0IDAtMi44ODMuNjMyLS42MzIuNzU2LS42NSA0LjY0My0uNjUgMy45NzkgMCAzLjk5
Ni4wMDMgNC42NDIuNy4zNTcuMzg1LjY1IDEuMDIzLjY1IDEuNDE3IDAgLjM5NC0uMjkzIDEuMDMx
LS42NSAxLjQxNi0uNjQ2LjY5OC0uNjYzLjctNC42NDMuNy0zLjk3OSAwLTMuOTk2LS4wMDItNC42
NDItLjd6bTE0LjgxNy4wNTFjLS40MS0uNDEtLjY1LS45NTItLjY1LTEuNDY3IDAtLjUxNi4yNC0x
LjA1OC42NS0xLjQ2Ny41NjctLjU2OC44ODYtLjY1IDIuNTI2LS42NSAxLjY5IDAgMS45NDIuMDcg
Mi41MjYuNy4zNTYuMzg1LjY0OCAxLjAyMy42NDggMS40MTcgMCAuMzk0LS4yOTIgMS4wMzEtLjY0
OCAxLjQxNy0uNTg0LjYzLS44MzYuNy0yLjUyNi43LTEuNjQgMC0xLjk1OS0uMDgyLTIuNTI2LS42
NXptMjYuMjA2IDM3LjkzYzUuNzg5LTIuNzI3IDYuNTQzLTEwLjkzNSAxLjMzNC0xNC41MTktMS4x
Ni0uNzk3LTEuMTgyLS44MDEtNC44NDItLjgwMS0zLjY0NiAwLTMuNjg4LjAwNy00Ljg3OS43OTYt
Mi4yNTYgMS40OTQtMy40OCAzLjkwMy0zLjQ5MiA2Ljg3Ny0uMDA3IDEuNTkyLjEyNiAyLjI3Mi42
NzMgMy40NCAxLjk5NyA0LjI2IDcuMDU4IDYuMTYxIDExLjIwNiA0LjIwN3ptLTEuNDU2LTIzLjEy
NXYtMy41NzJIMTA5LjI4OHY3LjE0NEgxMTMuNTIxem0tNy40MDgtMTguNDZjMC0uMDM5LTEuMTkt
MS4yNTctMi42NDYtMi43MDdsLTIuNjQ2LTIuNjM2djIuMDU4YzAgMS44MzIuMDcyIDIuMTI5LjY1
IDIuNzA3LjU3NS41NzUuODc5LjY1IDIuNjQ2LjY1IDEuMDk4IDAgMS45OTYtLjAzMyAxLjk5Ni0u
MDcyeiIgc3R5bGU9ImZpbGw6I2ZmZjtzdHJva2Utd2lkdGg6LjI2NDU4MztmaWxsLW9wYWNpdHk6
MSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTY0LjgxMSAtMTA0LjI4NykiLz48L3N2Zz4=)](https://openaccess.thecvf.com/content/CVPR2023W/E2EAD/papers/Klemp_LDFA_Latent_Diffusion_Face_Anonymization_for_Self-Driving_Applications_CVPRW_2023_paper.pdf)
# Latent Diffusion Face Anonymisation LDFA
This repository contains the code for the paper LDFA: Latent Diffusion Face Anonymization for Self-driving Applications.

## Usage
Please use the provided Docker container.

Prior to using this tool, please make sure that you have correctly set up the image, mask, anonymized, and weights volumes inside the `docker-compose.yml` file.
Furthermore, you can freely specify which GPU should be used.

`docker compose up`


Once the docker container is running you can generate masks using:

```shell
docker compose exec anon python3 /tool/scripts/detect_faces.py --image_dir=/data/images --mask_dir=/data/masks
```

and anonymize the detected faces using:

```shell
docker compose exec anon python3 /tool/scripts/ldfa_face_anon.py --image_dir=/data/images --mask_dir=/data/masks --output_dir=/data/anonymized
```

# Citation

If you are using LDFA in your research, please consider to cite us.

```bibtex
@InProceedings{Klemp_2023_CVPR,
    author    = {Klemp, Marvin and R\"osch, Kevin and Wagner, Royden and Quehl, Jannik and Lauer, Martin},
    title     = {LDFA: Latent Diffusion Face Anonymization for Self-Driving Applications},
    booktitle = {Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) Workshops},
    month     = {June},
    year      = {2023},
    pages     = {3198-3204}
}
```
